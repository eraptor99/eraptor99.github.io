<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weekly Timetable</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    table { table-layout: fixed; }
    th, td { text-align: center; vertical-align: middle; }
    td { height: 60px; }
  </style>
</head>
<body class="p-4">

<h2>Weekly Class Timetable</h2>

<table class="table table-bordered">
  <thead>
    <tr>
      <th>Time</th>
      <th>Monday</th>
      <th>Tuesday</th>
      <th>Wednesday</th>
      <th>Thursday</th>
      <th>Friday</th>
    </tr>
  </thead>
  <tbody id="timetableBody">
    <!-- Time slots will load dynamically -->
  </tbody>
</table>

<a href="dashboard.html" class="btn btn-secondary mt-3">Back</a>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
  apiKey: "AIzaSyDpzuExZHIX9VR9ykKQB-6tpxnzRU3WxTQ",
  authDomain: "studentplanner-d0933.firebaseapp.com",
  projectId: "studentplanner-d0933",
  storageBucket: "studentplanner-d0933.firebasestorage.app",
  messagingSenderId: "734911455270",
  appId: "1:734911455270:web:a5f0381a14c6d3fb31c6e7",
  measurementId: "G-F8B40LEWVP"
};

  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"];
  const timeSlots = ["09:00 - 10:30", "10:30 - 12:00", "13:00 - 14:30", "14:30 - 16:00"];

  const tbody = document.getElementById("timetableBody");

  // Initialize empty timetable
  const timetable = {};
  timeSlots.forEach(time => {
    timetable[time] = {};
    days.forEach(day => {
      timetable[time][day] = ""; // empty cell
    });
  });

  // Load schedule from Firestore
  db.collection("schedule").get()
    .then(snapshot => {
      snapshot.forEach(doc => {
        const data = doc.data();
        const day = data.Day;
        const time = data.Time;
        if (timetable[time] && timetable[time][day] !== undefined) {
          timetable[time][day] = `${data.Subject} (${data.Room})\n${data.Teacher}`;
        }
      });

      // Render timetable
      timeSlots.forEach(time => {
        const row = document.createElement("tr");
        const timeCell = document.createElement("td");
        timeCell.textContent = time;
        row.appendChild(timeCell);

        days.forEach(day => {
          const cell = document.createElement("td");
          cell.innerHTML = timetable[time][day].replace(/\n/g, "<br>");
          row.appendChild(cell);
        });

        tbody.appendChild(row);
      });
    })
    .catch(error => {
      console.error("Error loading timetable:", error);
      alert("Failed to load timetable");
    });
</script>

</body>
</html>
