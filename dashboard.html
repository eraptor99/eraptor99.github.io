<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">

  <style>
    .card { border-radius: 12px; }
    .btn-rounded { border-radius: 8px; }
    #announcementList li:hover { background-color: #f0f8ff; }
    .badge-active { background-color: #28a745; color: white; }
    .badge-inactive { background-color: #dc3545; color: white; }
  </style>
</head>
<body class="p-4 bg-light">

<div class="container">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>ğŸ“Š Student Dashboard</h2>
    <button id="logoutBtn" class="btn btn-danger btn-rounded">Logout</button>
  </div>

  <div class="row mb-4">
    <div class="col-md-6">
      <div class="card shadow-sm p-3 text-center">
        <h4>ğŸ‘©â€ğŸ“ Students</h4>
        <p>View and manage students</p>
        <a href="students.html" class="btn btn-primary btn-rounded">Go</a>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card shadow-sm p-3 text-center">
        <h4>ğŸ“… Schedule</h4>
        <p>View and manage class schedule</p>
        <a href="schedule.html" class="btn btn-primary btn-rounded">Go</a>
      </div>
    </div>
  </div>
    <div class="col-md-3">
    <div class="card shadow-sm p-3 text-center h-100">
      <h4>â„¹ï¸ About</h4>
      <p>About this website</p>
      <a href="about.html" class="btn btn-secondary btn-rounded">Open</a>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card shadow-sm p-3 text-center h-100">
      <h4>âœ‰ï¸ Contact</h4>
      <p>Send a message</p>
      <a href="contact.html" class="btn btn-secondary btn-rounded">Open</a>
    </div>
  </div>
</div>

  <div class="card shadow-sm">
    <div class="card-body">
      <h4>ğŸ“¢ Announcements</h4>

      <ul id="announcementList" class="list-group mb-3"></ul>

      <form id="announcementForm" class="d-flex gap-2 mb-2">
        <input type="text" id="annTitle" class="form-control" placeholder="Title" required>
        <input type="text" id="annMessage" class="form-control" placeholder="Message" required>
        <button class="btn btn-success btn-rounded">Save</button>
      </form>
    </div>
  </div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
 
  const firebaseConfig = {
    apiKey: "AIzaSyDpzuExZHIX9VR9ykKQB-6tpxnzRU3WxTQ",
    authDomain: "studentplanner-d0933.firebaseapp.com",
    projectId: "studentplanner-d0933",
    storageBucket: "studentplanner-d0933.firebasestorage.app",
    messagingSenderId: "734911455270",
    appId: "1:734911455270:web:a5f0381a14c6d3fb31c6e7"
  };

  
  const app = firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  
  auth.onAuthStateChanged(user => {
    if (!user) window.location.href = "login.html";
  });

  
  document.getElementById("logoutBtn").addEventListener("click", () => {
    auth.signOut().then(() => window.location.href = "login.html");
  });

  
  const annList = document.getElementById("announcementList");
  const annForm = document.getElementById("announcementForm");
  const annTitle = document.getElementById("annTitle");
  const annMessage = document.getElementById("annMessage");

  let editAnnId = null; // 

  
  function loadAnnouncements() {
    annList.innerHTML = "";
    db.collection("announcements").orderBy("timestamp", "desc").get()
      .then(snapshot => {
        snapshot.forEach(doc => {
          const a = doc.data();
          const li = document.createElement("li");
          li.className = "list-group-item d-flex justify-content-between align-items-center";
          li.innerHTML = `
            <div><strong>${a.title}</strong>: ${a.message}</div>
            <div>
              <button class="btn btn-sm btn-warning me-1">Edit</button>
              <button class="btn btn-sm btn-danger">Delete</button>
            </div>
          `;

          
          li.querySelector(".btn-warning").addEventListener("click", () => {
            annTitle.value = a.title;
            annMessage.value = a.message;
            editAnnId = doc.id;
          });

          
          li.querySelector(".btn-danger").addEventListener("click", () => {
            if(confirm(`Delete announcement "${a.title}"?`)) {
              db.collection("announcements").doc(doc.id).delete().then(loadAnnouncements);
            }
          });

          annList.appendChild(li);
        });
      });
  }

  loadAnnouncements(); 

  
  annForm.addEventListener("submit", e => {
    e.preventDefault();
    const data = {
      title: annTitle.value,
      message: annMessage.value,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    };

    if(editAnnId) {
      db.collection("announcements").doc(editAnnId).set(data).then(() => {
        annForm.reset();
        editAnnId = null;
        loadAnnouncements();
      });
    } else {
      db.collection("announcements").add(data).then(() => {
        annForm.reset();
        loadAnnouncements();
      });
    }
  });
</script>

</body>
</html>
